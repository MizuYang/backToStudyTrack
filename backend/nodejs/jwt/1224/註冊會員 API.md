# 會員註冊 API

## 會員註冊流程

```
使用者輸入帳號、密碼、暱稱、信箱、生日、性別
使用者點擊發送驗證信箱按鈕
使用者收到驗證信後，複製裡面的驗證碼，並將驗證碼貼到註冊頁的驗證欄位中
使用者按下註冊按鈕
```

## 欄位、格式

```
帳號: 只能是英文、數字，且長度 4~16 字元
密碼: 只能是英文、數字，且長度 8~20 字元
暱稱: 只能是中文、英文、數字，且長度 2~10 字元
信箱: 必須符合 email 格式
生日: 必須為有效日期，年齡必須大於18歲
性別: 只能是男或女
```

## API

```javascript
apiName: 註冊會員
baseUrl: /user/api/v1
method: POST
path: /register
query:
body:
{
  "account": "string",
  "password": "string",
  "nickname": "string",
  "email": "string",
  "birthday": "string",
  "gender": "string",
  "emailVerificationCode": "string"
}
response:
{
"status": "success",
"statusCode": 200,
"message": "註冊成功"
},
{
"status": "fail",
"statusCode": 400,
"message": "註冊失敗"
}
```

## API 處理流程

- 檢查所有欄位是否為空
- 檢查所有欄位格式是否正確
- [資料庫] 檢查 帳號 | 信箱 是否已被使用
- [資料庫] 檢查信箱驗證碼: 是否有值、是否過期、是否有剩餘可驗證次數、是否正確
  <!-- - 若信箱沒有值，回傳 400 (第一個步驟已有檢查欄位是否為空) -->
  - 若驗證碼過期，回傳 400，「您的驗證碼已過期，請重新發送驗證碼」
  - 若無剩餘可驗證次數，回傳 400，「您的驗證碼錯誤太多次，請重新發送驗證碼」
  - 驗證碼是否正確
    - 正確：繼續流程
    - 錯誤：扣除一次可驗證次數
      - 若扣除後還有剩餘次數，回傳 400，「驗證碼錯誤，剩餘 n 次驗證機會」
      - 若扣除後無剩餘次數，回傳 400，「驗證碼錯誤太多次，請重新發送驗證碼」
- 將使用者密碼加密，將使用者資料寫入資料庫
- 清除信箱驗證碼
- 發送會員註冊成功通知信
- 回傳註冊成功響應
